%
% 2023/11/30
%
% 3つのピークを別々に描画する必要がありそう．
%

\documentclass[tikz,border=0.5cm,varwidth=12cm]{standalone}
% https://latexdraw.com/plot-a-function-and-data-in-latex/

\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{physics}

\pgfplotsset{compat = newest}
\pgfplotsset{every axis/.append style={
                    title style={font=\Large},
                    label style={font=\huge},
                    tick label style={font=\Large},
                   }}

\usepgfplotslibrary{colorbrewer}
\usetikzlibrary{pgfplots.colorbrewer}
\usetikzlibrary{arrows.meta,backgrounds}
\tikzset{white background/.style={show background rectangle,tight background,background rectangle/.style={fill=white}}}

\begin{document}

% debye緩和のparameter
\def\Deps0{25}
\def\Depsinf0{17}
\def\Dtau0{0.1}

% 1つめのlorentz緩和のparameter
\def\eps0{17}
\def\epsinf{14}
\def\gamma{300}
\def\freq0{1000}

% 2つめのlorentz緩和のparameter
\def\Leps0{14}
\def\Lepsinf{10}
\def\Lgamma{20000}
\def\Lfreq0{50000}


    \begin{tikzpicture}[white background]
     \tikzset{every node}=[font=\Large]
        % axis環境が2次元plot
     \begin{axis}[ %グラフ設定
	    xmode=log,
            xmin = 0.01/\Dtau0, xmax = 100000/\Dtau0,
            ymin = 0.00, ymax = 40,
            % ticks=none,
	    xlabel=$\log \left(\mathrm{Frequency}\right)$,
	    ylabel=$\varepsilon$,
            title=Dielectric function,
            % grid = both,
            % minor tick num = 1,
            major grid style = {lightgray},
            minor grid style = {lightgray!25},
            width = 10cm, height = 8cm,
%            height = 0.75\textwidth,
 %           legend cell align = {left},
%            legend pos = outer north east,
            % https://tex.stackexchange.com/questions/273611/line-up-extra-y-tick-labels-with-extra-y-ticks
            xtick={\empty},
            ytick={\empty},
            extra x ticks={10,100,1000,50000},
            extra x tick labels={GHz,THz,IR,UV},
            extra y ticks={32},
            extra y tick labels={$\varepsilon_0$},
        ]
            \node[font=\Large] at (2,35)   {Orientation};
            \node[font=\Large] at (500,35)  {Atomic};
            \node[font=\Large] at (60000,35) {Electronic};
            \node[font=\Large,color=Set1-A] at (10,25) {$\varepsilon'$};
            \node[font=\Large,color=Set1-B] at (10,7) {$\varepsilon''$};
            
            % \coordinate (A) at (100,27);
	    % \coordinate (B) at (1000,27);
	    % \coordinate (C) at (50000,27);


	 % 実部
	 \addplot[domain = 0.01/\Dtau0:100000/\Dtau0,samples=1000,line width =2, Set1-A] {\Depsinf0+(\Deps0-\Depsinf0)/(1+\Dtau0*\Dtau0*x*x)+(\eps0-\epsinf)*\freq0*\freq0*(\freq0*\freq0-x*x)/((\freq0*\freq0-x*x)*(\freq0*\freq0-x*x)+\gamma*\gamma*x*x)+(\Leps0-\Lepsinf)*\Lfreq0*\Lfreq0*(\Lfreq0*\Lfreq0-x*x)/((\Lfreq0*\Lfreq0-x*x)*(\Lfreq0*\Lfreq0-x*x)+\Lgamma*\Lgamma*x*x)};
	 % 虚部
	 \addplot[domain = 0.01/\Dtau0:100000/\Dtau0,samples=1000, line width=2, Set1-B] {(\Deps0-\Depsinf0)*\Dtau0*x/(1+\Dtau0*\Dtau0*x*x)+\gamma*(\eps0-\epsinf)*\freq0*\freq0*x/((\freq0*\freq0-x*x)*(\freq0*\freq0-x*x)+\gamma*\gamma*x*x)+\Lgamma*(\Leps0-\Lepsinf)*\Lfreq0*\Lfreq0*x/((\Lfreq0*\Lfreq0-x*x)*(\Lfreq0*\Lfreq0-x*x)+\Lgamma*\Lgamma*x*x)};


	 % % 実部(lorentz 1)
	 % \addplot[domain = 10/\Dtau0:1000/\Dtau0,samples=1000,thick,blue] {\epsinf+(\eps0-\epsinf)*\freq0*\freq0*(\freq0*\freq0-x*x)/((\freq0*\freq0-x*x)*(\freq0*\freq0-x*x)+\gamma*\gamma*x*x)};
	 % % 虚部
	 % \addplot[domain = 10/\Dtau0:1000/\Dtau0,samples=1000,thick,red] {\gamma*(\eps0-\epsinf)*\freq0*\freq0*x/((\freq0*\freq0-x*x)*(\freq0*\freq0-x*x)+\gamma*\gamma*x*x)};


	 % % 実部(lorentz 2)
	 % \addplot[domain = 1000/\Dtau0:100000/\Dtau0,samples=1000,thick,blue] {\Lepsinf+(\Leps0-\Lepsinf)*\Lfreq0*\Lfreq0*(\Lfreq0*\Lfreq0-x*x)/((\Lfreq0*\Lfreq0-x*x)*(\Lfreq0*\Lfreq0-x*x)+\Lgamma*\Lgamma*x*x)};
	 % % 虚部
	 % \addplot[domain = 1000/\Dtau0:100000/\Dtau0,samples=1000,thick,red] {\Lgamma*(\Leps0-\Lepsinf)*\Lfreq0*\Lfreq0*x/((\Lfreq0*\Lfreq0-x*x)*(\Lfreq0*\Lfreq0-x*x)+\Lgamma*\Lgamma*x*x)};

%      \legend{$\varepsilon'$, $\varepsilon''$}


\end{axis}
\end{tikzpicture}
\end{document}
